import{Keccak as t,SHA3 as e}from"sha3";import r from"base-x";import{Buffer as n}from"safe-buffer";import i from"big-integer";import o from"bs58";import{RIPEMD160 as f}from"ripemd160-min";import{blake2b as s}from"blakejs/blake2b";const h="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",c=t=>{for(var e=t.toString(),r="",n=0;n<e.length;n+=2)r+=String.fromCharCode(parseInt(e.substr(n,2),16));return r};var u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];const a=t=>{for(var e="",r=0;r<t.length;r++){var n=t[r];e+=u[n>>>4],e+=u[15&n]}return e},l=function(t){for(var e=new ArrayBuffer(5*t.length/8),r=new Uint8Array(e),n=0;n<t.length/8;n++){for(var i=[0,0,0,0,0,0,0,0],o=0;o<8;++o)i[o]=h.indexOf(t[8*n+o]);r[5*n+0]=i[0]<<3|i[1]>>2,r[5*n+1]=(3&i[1])<<6|i[2]<<1|i[3]>>4,r[5*n+2]=(15&i[3])<<4|i[4]>>1,r[5*n+3]=(1&i[4])<<7|i[5]<<2|i[6]>>3,r[5*n+4]=(7&i[6])<<5|i[7]}return r},d=function(t){var e=[],r=Math.floor(t.length/5),n=t.length%5;if(0!=n){for(var i=0;i<5-n;i++)t+="\0";r+=1}for(var o=0;o<r;o++)e.push(h.charAt(t.charCodeAt(5*o)>>3)),e.push(h.charAt((7&t.charCodeAt(5*o))<<2|t.charCodeAt(5*o+1)>>6)),e.push(h.charAt((63&t.charCodeAt(5*o+1))>>1)),e.push(h.charAt((1&t.charCodeAt(5*o+1))<<4|t.charCodeAt(5*o+2)>>4)),e.push(h.charAt((15&t.charCodeAt(5*o+2))<<1|t.charCodeAt(5*o+3)>>7)),e.push(h.charAt((127&t.charCodeAt(5*o+3))>>2)),e.push(h.charAt((3&t.charCodeAt(5*o+3))<<3|t.charCodeAt(5*o+4)>>5)),e.push(h.charAt(31&t.charCodeAt(5*o+4)));var f=0;1==n?f=6:2==n?f=4:3==n?f=3:4==n&&(f=1);for(var s=0;s<f;s++)e.pop();for(var c=0;c<f;c++)e.push("=");return e.join("")},p=t=>{let e=t.toString().toUpperCase().replace(/-/g,"");if(!e||40!==e.length)return!1;let r=g(l(e));return v(Buffer.from(r.slice(0,42),"hex"))===r.slice(42)},g=t=>{let e="";for(let r=0;r<t.length;r++){let n=Math.round(t[r]).toString(16);1===n.length&&(n="0"+n),e+=n}return e},v=e=>new t(256).update(e).digest("hex").toString().substr(0,8);function m(t,e){this._block=n.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}m.prototype.update=function(t,e){"string"==typeof t&&(t=n.from(t,e=e||"utf8"));for(var r=this._block,i=this._blockSize,o=t.length,f=this._len,s=0;s<o;){for(var h=f%i,c=Math.min(o-s,i-h),u=0;u<c;u++)r[h+u]=t[s+u];s+=c,(f+=c)%i==0&&this._update(r)}return this._len+=o,this},m.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(4294967295&r)>>>0;this._block.writeUInt32BE((r-n)/4294967296,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var i=this._hash();return t?i.toString(t):i},m.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var w,y,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_=new Array(64);function I(){this.init(),this._w=_,m.call(this,64,56)}function E(t,e,r){return r^t&(e^r)}function B(t,e,r){return t&e|r&(t|e)}function x(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function A(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function S(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}w=I,(y=m)&&(w.super_=y,w.prototype=Object.create(y.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}})),I.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},I.prototype._update=function(t){for(var e,r=this._w,n=0|this._a,i=0|this._b,o=0|this._c,f=0|this._d,s=0|this._e,h=0|this._f,c=0|this._g,u=0|this._h,a=0;a<16;++a)r[a]=t.readInt32BE(4*a);for(;a<64;++a)r[a]=0|(((e=r[a-2])>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+r[a-7]+S(r[a-15])+r[a-16];for(var l=0;l<64;++l){var d=u+A(s)+E(s,h,c)+b[l]+r[l]|0,p=x(n)+B(n,i,o)|0;u=c,c=h,h=s,s=f+d|0,f=o,o=i,i=n,n=d+p|0}this._a=n+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=f+this._d|0,this._e=s+this._e|0,this._f=h+this._f|0,this._g=c+this._g|0,this._h=u+this._h|0},I.prototype._hash=function(){var t=n.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t};const z={sha256:function(t){return(new I).update(Buffer.from(t)).digest()},alphabet:"rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"},k=new class{constructor(t){this.sha256=t.sha256,this.alphabet=t.alphabet,this.codec=r(this.alphabet),this.base=this.alphabet.length}encodeChecked(t){const e=this.sha256(this.sha256(t)).slice(0,4);return this.encodeRaw(Buffer.from(function(...t){const e=[];return t.forEach(function(t){if(void 0!==t.length)for(let r=0;r<t.length;r++)e.push(t[r]);else e.push(t)}),e}(t,e)))}encodeRaw(t){return this.codec.encode(t)}decodeChecked(t){const e=this.decodeRaw(t);if(e.length<5)throw new Error("invalid_input_size: decoded data must have length >= 5");if(!this.verifyCheckSum(e))throw new Error("checksum_invalid");return e.slice(0,-4)}decodeRaw(t){return this.codec.decode(t)}verifyCheckSum(t){return function(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(this.sha256(this.sha256(t.slice(0,-4))).slice(0,4),t.slice(-4))}}(z),C=t=>"0x"===t.slice(0,2)?t.slice(2):t,O=(e,r=null)=>{if("string"!=typeof e)throw new Error("stripHexPrefix param must be type 'string', is currently type "+typeof e+".");const n=C(e).toLowerCase(),i=(o=(null!=r?r.toString()+"0x":"")+n,new t(256).update(o).digest()).toString("hex");var o;let f="0x";for(let t=0;t<n.length;t++)f+=parseInt(i[t],16)>=8?n[t].toUpperCase():n[t];return f};function U(t,e){return function(t){return/^0x[0-9a-fA-F]{40}$/.test(t)}(t)&&O(t,e)===t}const L=(t,e)=>{if(!t)throw e},P=(t,e)=>{if(!Buffer.isBuffer(t))throw e},q=i.one,M=i.zero,T=i(3);function F(t,e){return t.and(q.shiftLeft(e)).notEquals(M)}function j(t){return i.fromArray(Array.prototype.slice.call(t,0),256)}function R(t,e){const{value:r}=t.toArray(256),n=e?Math.max(e-r.length,0):0;return Buffer.from([...Array(n).fill(0),...r])}function G(t,e,r,n){L(void 0!==n,"Missing Z coordinate"),this.curve=t,this.x=e,this.y=r,this.z=n,this._zInv=null,this.compressed=!0}Object.defineProperty(G.prototype,"zInv",{get:function(){return null===this._zInv&&(this._zInv=this.z.modInv(this.curve.p)),this._zInv}}),Object.defineProperty(G.prototype,"affineX",{get:function(){return this.x.multiply(this.zInv).mod(this.curve.p)}}),Object.defineProperty(G.prototype,"affineY",{get:function(){return this.y.multiply(this.zInv).mod(this.curve.p)}}),G.fromAffine=function(t,e,r){return new G(t,e,r,q)},G.prototype.equals=function(t){return t===this||(this.curve.isInfinity(this)?this.curve.isInfinity(t):this.curve.isInfinity(t)?this.curve.isInfinity(this):0===t.y.multiply(this.z).subtract(this.y.multiply(t.z)).mod(this.curve.p).compare(M)&&0===t.x.multiply(this.z).subtract(this.x.multiply(t.z)).mod(this.curve.p).compare(M))},G.prototype.negate=function(){var t=this.curve.p.subtract(this.y);return new G(this.curve,this.x,t,this.z)},G.prototype.add=function(t){if(this.curve.isInfinity(this))return t;if(this.curve.isInfinity(t))return this;var e=this.x,r=this.y,n=t.x,i=t.y.multiply(this.z).subtract(r.multiply(t.z)).mod(this.curve.p),o=n.multiply(this.z).subtract(e.multiply(t.z)).mod(this.curve.p);if(0===o.compare(M))return 0===i.compare(M)?this.twice():this.curve.infinity;var f=o.square(),s=f.multiply(o),h=e.multiply(f),c=i.square().multiply(this.z),u=c.subtract(h.shiftLeft(1)).multiply(t.z).subtract(s).multiply(o).mod(this.curve.p),a=h.multiply(T).multiply(i).subtract(r.multiply(s)).subtract(c.multiply(i)).multiply(t.z).add(i.multiply(s)).mod(this.curve.p),l=s.multiply(this.z).multiply(t.z).mod(this.curve.p);return new G(this.curve,u,a,l)},G.prototype.twice=function(){if(this.curve.isInfinity(this))return this;if(0===this.y.compare(M))return this.curve.infinity;var t=this.x,e=this.y,r=e.multiply(this.z).mod(this.curve.p),n=r.multiply(e).mod(this.curve.p),i=this.curve.a,o=t.square().multiply(T);0!==i.compare(M)&&(o=o.add(this.z.square().multiply(i)));var f=(o=o.mod(this.curve.p)).square().subtract(t.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(r).mod(this.curve.p),s=o.multiply(T).multiply(t).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(o.pow(3)).mod(this.curve.p),h=r.pow(3).shiftLeft(3).mod(this.curve.p);return new G(this.curve,f,s,h)},G.prototype.multiply=function(t){if(this.curve.isInfinity(this))return this;if(0===t.compare(M))return this.curve.infinity;for(var e=t,r=e.multiply(T),n=this.negate(),i=this,o=r.bitLength()-2;o>0;--o){var f=F(r,o),s=F(e,o);i=i.twice(),f!==s&&(i=i.add(f?this:n))}return i},G.prototype.multiplyTwo=function(t,e,r){for(var n=Math.max(t.bitLength(),r.bitLength())-1,i=this.curve.infinity,o=this.add(e);n>=0;){var f=F(t,n),s=F(r,n);i=i.twice(),f?i=i.add(s?o:this):s&&(i=i.add(e)),--n}return i},G.prototype.getEncoded=function(t){if(null==t&&(t=this.compressed),this.curve.isInfinity(this))return new Buffer("00","hex");var e,r=this.affineX,n=this.affineY,i=this.curve.pLength;return t?(e=new Buffer(1+i)).writeUInt8(n.isEven()?2:3,0):((e=new Buffer(1+i+i)).writeUInt8(4,0),R(n,i).copy(e,1+i)),R(r,i).copy(e,1),e},G.decodeFrom=function(t,e){var r,n=e.readUInt8(0),i=4!==n,o=Math.floor((t.p.bitLength()+7)/8),f=j(e.slice(1,1+o));if(i)L(e.length===o+1,"Invalid sequence length"),L(2===n||3===n,"Invalid sequence tag"),r=t.pointFromX(3===n,f);else{L(e.length===1+o+o,"Invalid sequence length");var s=j(e.slice(1+o));r=G.fromAffine(t,f,s)}return r.compressed=i,r},G.prototype.toString=function(){return this.curve.isInfinity(this)?"(INFINITY)":"("+this.affineX.toString()+","+this.affineY.toString()+")"};const H=i.zero,N=i.one;function X(t,e,r,n,i,o,f){this.p=t,this.a=e,this.b=r,this.G=G.fromAffine(this,n,i),this.n=o,this.h=f,this.infinity=new G(this,null,null,H),this.pOverFour=t.add(N).shiftRight(2),this.pLength=Math.floor((this.p.bitLength()+7)/8)}X.prototype.pointFromX=function(t,e){var r=e.pow(3).add(this.a.multiply(e)).add(this.b).mod(this.p).modPow(this.pOverFour,this.p),n=r;return r.isEven()^!t&&(n=this.p.subtract(n)),G.fromAffine(this,e,n)},X.prototype.isInfinity=function(t){return t===this.infinity||0===t.z.compare(H)&&0!==t.y.compare(H)},X.prototype.isOnCurve=function(t){if(this.isInfinity(t))return!0;var e=t.affineX,r=t.affineY,n=this.a,i=this.b,o=this.p;if(e.compare(H)<0||e.compareTo(o)>=0)return!1;if(r.compare(H)<0||r.compareTo(o)>=0)return!1;var f=r.square().mod(o),s=e.pow(3).add(n.multiply(e)).add(i).mod(o);return f.equals(s)},X.prototype.validate=function(t){L(!this.isInfinity(t),"Point is at infinity"),L(this.isOnCurve(t),"Point is not on the curve");var e=t.multiply(this.n);return L(this.isInfinity(e),"Point is not a scalar multiple of G"),!0};var Y={p:"fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f",a:"00",b:"07",n:"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",h:"01",Gx:"79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798",Gy:"483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"};function K(t,r){return new e(256).update(t).digest(r)}function Q(t){return Buffer.from((new f).update(t).digest())}function Z(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(P(t,"expecting keyBuffer<Buffer>"),"sha256x2"===e){const e=K(K(t)).slice(0,4);return o.encode(Buffer.concat([t,e]))}{const r=[t];e&&r.push(Buffer.from(e));const n=Q(Buffer.concat(r)).slice(0,4);return o.encode(Buffer.concat([t,n]))}}function D(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;L(t,"private key expected");const r=new Buffer(o.decode(t)),n=r.slice(-4),i=r.slice(0,-4);let f;if("sha256x2"===e)f=K(K(i)).slice(0,4);else{const t=[i];e&&t.push(Buffer.from(e)),f=Q(Buffer.concat(t)).slice(0,4)}if(n.toString("hex")!==f.toString("hex"))throw new Error("Invalid checksum, "+"".concat(n.toString("hex")," != ").concat(f.toString("hex")));return i}const V=function(t){const e=Y;if(!e)return null;const r=i(e.p,16),n=i(e.a,16),o=i(e.b,16),f=i(e.n,16),s=i(e.h,16);return new X(r,n,o,i(e.Gx,16),i(e.Gy,16),f,s)}();function J(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EOS";if("string"==typeof t)return J.fromString(t,e);if(Buffer.isBuffer(t))return J.fromBuffer(t);if("object"==typeof t&&t.Q)return J(t.Q);function r(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.compressed;return t.getEncoded(e)}function n(){const t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EOS";return t+Z(r())}function i(){return r().toString("hex")}return{Q:t,toString:n,toBuffer:r,toHex:i}}J.isValid=function(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EOS";try{return J(t,e),!0}catch(t){return!1}},J.fromBuffer=function(t){return J(G.decodeFrom(V,t))},J.fromString=function(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EOS";try{return J.fromStringOrThrow(t,e)}catch(t){return null}},J.fromStringOrThrow=function(t){const e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EOS",r=t.match(/^PUB_([A-Za-z0-9]+)_([A-Za-z0-9]+)$/);if(null===r)return new RegExp("^"+e).test(t)&&(t=t.substring(e.length)),J.fromBuffer(D(t));const[,n,i]=r;return J.fromBuffer(D(i,n))},J.fromHex=function(t){return J.fromBuffer(new Buffer(t,"hex"))},J.fromStringHex=function(t){return J.fromString(new Buffer(t,"hex"))};const{encode:W,decode:$}=r("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),tt=t=>void 0===t;var et={ed25519PublicKey:48,ed25519SecretSeed:144,preAuthTx:152,sha256Hash:184};const rt=(t,e)=>{if("string"!=typeof e)throw new TypeError("encoded argument must be of type String");var r=$(e),n=r[0],i=r.slice(0,-2),o=i.slice(1),f=r.slice(-2);if(e!==W(r))throw new Error("invalid encoded string");var s=et[t];if(tt(s))throw new Error(t+' is not a valid version byte name.  expected one of "accountId" or "seed"');if(n!==s)throw new Error("invalid version byte. expected "+s+", got "+n);var h=it(i);if(!ot(h,f))throw new Error("invalid checksum");return Buffer.from(o)},nt=(t,e)=>{if(null===e||tt(e))throw new Error("cannot encode null data");var r=et[t];if(tt(r))throw new Error(t+' is not a valid version byte name.  expected one of "ed25519PublicKey", "ed25519SecretSeed", "preAuthTx", "sha256Hash"');e=Buffer.from(e);var n=Buffer.from([r]),i=Buffer.concat([n,e]),o=it(i),f=Buffer.concat([i,o]);return W(f)},it=t=>{var e=Buffer.alloc(2);return e.writeUInt16LE(((t,e)=>{Buffer.isBuffer(t)||(t=new Buffer);let r=0;for(let e=0;e<t.length;e++){let n=r>>>8&255;n^=255&t[e],n^=n>>>4,r=r<<8&65535,r^=n,n=n<<5&65535,r^=n,n=n<<7&65535,r^=n}return r})(t),0),e},ot=(t,e)=>{if(t.length!==e.length)return!1;if(0===t.length)return!0;for(let r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0},ft=[0,1,2,42,43,68,69],st=function(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}("SS58PRE");class ht extends Number{toJSON(){return{_type:"AccountIndex",data:this+0}}}function ct(t,e){t.length||(t=[t]),e.length||(e=[e]);const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function ut(t,e=42,r=null,n=null,i){let f;if(-1===ft.indexOf(e))throw new Error("Unknown ss58 address type",e);if("number"==typeof t||t instanceof ht){let e=t<256?1:t<65536?2:t<1?4:8;if(-1===[1,2,4,8].indexOf(n=n||e))throw new Error("Invalid length");if(n=Math.max(e,n),r&&"number"!=typeof r)throw new Error("Invalid checksum length");switch(n){case 1:r=1;break;case 2:r=[1,2].indexOf(r)+1||1;break;case 4:r=[1,2,3,4].indexOf(r)+1||1;break;case 8:r=[1,2,3,4,5,6,7,8].indexOf(r)+1||1}f=function(t,e){let r=!1;t<0&&(t=-t-1,r=!0);let n=new Uint8Array(e);for(var i=0;i<e;++i)n[i]=t%256,r&&(n[i]=255&~n[i]),t/=256;return n}(t,n)}else{if(!(t instanceof Uint8Array)||32!==t.length&&35!==t.length)throw new Error("Unknown item to encode as ss58. Passing back.",t);r=2,f=35===t.length?t.slice(1,33):t,i=f}let h=s(ct(st,1&e?i:ct(e,f))),c=ct(ct(e,f),h.slice(0,r));return o.encode(Buffer.from(c))}function at(t,e=0){let r;try{r=o.decode(t)}catch(t){return null}if(-1===ft.indexOf(r[0]))return null;if(r.length<3)return null;let n,i=r.length<=3?1:r.length<=5?2:r.length<=9?4:r.length<=17?8:32,f=r.length-1-i,h=r.slice(1,1+i);r.slice(1+r.length),32===i&&(n=h);let c=i<32?new ht(function(t){let e=0,r=1;return t.forEach(t=>{e+=t*r,r*=256}),e}(h)):new Buffer.from(h);if(r[0]%1&&!n&&!e)return null;let u=s(ct(st,r[0]%1?n||e(c):r.slice(0,1+i)));for(var a=0;a<f;++a)if(u[a]!==r[1+i+a])return null;return c}function lt(t){var e=new Error;this.name=e.name="ValidationError",this.message=e.message=t,this.stack=e.stack}function dt(t,e){if(null==e&&(e="Assertion failed."),!t)throw new lt(e)}lt.prototype=Object.create(Error.prototype);class pt{constructor(t,e){this.hi=0|t,this.lo=0|e}ushrn32(t){let e=this.lo;return 0==(t&=63)||(t<32?(e>>>=t,e|=this.hi<<32-t):e=this.hi>>>t-32),e}}const gt=Buffer.allocUnsafe(105),vt="qpzry9x8gf2tvdw0s3jn54khce6mua7l",mt=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1],wt=new pt(7,4294967295),yt=[new pt(152,4072443489),new pt(121,3077413346),new pt(243,1046459332),new pt(174,783016616),new pt(30,1329849456)];function bt(t,e){const r=t,n=r.hi>>>3;r.hi&=wt.hi,r.lo&=wt.lo,r.hi<<=5,r.hi|=r.lo>>>27,r.lo<<=5;for(let t=0;t<yt.length;t++)n>>>t&1&&(r.hi^=yt[t].hi,r.lo^=yt[t].lo);return r.lo^=e,r}function _t(t,e,r,n,i,o,f){dt(Buffer.isBuffer(t)),dt(e>>>0===e),dt(Buffer.isBuffer(r)),dt(n>>>0===n),dt((255&i)===i),dt((255&o)===o),dt("boolean"==typeof f);const s=(1<<o)-1;let h=0,c=0;for(;e<t.length;e++){const f=t[e];if(f>>>i!=0)throw new Error("Invalid bits.");for(h=h<<i|f,c+=i;c>=o;)c-=o,r[n++]=h>>>c&s}if(f)c&&(r[n++]=h<<o-c&s);else if(c>=i||h<<o-c&s)throw new Error("Invalid bits.");return dt(n<=r.length),r.slice(0,n)}function It(t,e,r){if(dt("string"==typeof t),dt((15&e)===e,"Invalid cashaddr type."),dt(Buffer.isBuffer(r)),0===t.length||t.length>83)throw new Error("Invalid cashaddr prefix.");const n=function(t){switch(dt(t>>>0===t),t){case 20:return 0;case 24:return 1;case 28:return 2;case 32:return 3;case 40:return 4;case 48:return 5;case 56:return 6;case 64:return 7;default:throw new Error("Non standard length.")}}(r.length),i=Buffer.allocUnsafe(r.length+1);return i[0]=e<<3|n,r.copy(i,1),function(t,e){dt("string"==typeof t),dt(Buffer.isBuffer(e));const r=new pt(0,1);let n="",i=!1,o=!1;for(let e=0;e<t.length;e++){let f=t.charCodeAt(e);if(65280&f||f>>>5==0)throw new Error("Invalid cashaddr character.");if(f>=97&&f<=122)o=!0;else if(f>=65&&f<=90)i=!0,f=f-65+97;else if(f>=48&&f<=57)throw new Error("Invalid cashaddr prefix.");bt(r,31&f),n+=String.fromCharCode(f)}if(o&&i)throw new Error("Invalid cashaddr prefix.");bt(r,0),n+=":";for(let t=0;t<e.length;t++){const i=e[t];if(i>>>5!=0)throw new Error("Invalid cashaddr value.");bt(r,i),n+=vt[i]}for(let t=0;t<8;t++)bt(r,0);r.lo^=1;for(let t=0;t<8;t++){const e=31&r.ushrn32(5*(7-t));n+=vt[e]}return n}(t,_t(i,0,gt,0,8,5,!0))}function Et(t,e="bitcoincash"){dt("string"==typeof t),dt("string"==typeof e);const[r,n]=function(t,e){if(dt("string"==typeof t),t.length<8||t.length>196)throw new Error("Invalid cashaddr data length.");let r=!1,n=!1,i=!1,o=0;for(let e=0;e<t.length;e++){const f=t.charCodeAt(e);if(f>=97&&f<=122)r=!0;else if(f>=65&&f<=90)n=!0;else if(f>=48&&f<=57)i=!0;else{if(58!==f)throw new Error("Invalid cashaddr character.");if(i||0===e||e>83)throw new Error("Invalid cashaddr prefix.");if(0!==o)throw new Error("Invalid cashaddr separators.");o=e}}if(n&&r)throw new Error("Invalid cashaddr casing.");const f=new pt(0,1);let s;0===o?s=e.toLowerCase():(s=t.substring(0,o).toLowerCase(),o+=1);for(let t=0;t<s.length;t++)bt(f,31&(32|s.charCodeAt(t)));bt(f,0);const h=t.length-o;if(h<=8||h>112)throw new Error("Invalid cashaddr data length.");const c=Buffer.allocUnsafe(h);for(let e=o;e<t.length;e++){const r=t.charCodeAt(e),n=65408&r?-1:mt[r];if(-1===n)throw new Error("Invalid cashaddr character.");bt(f,n),e+8<t.length&&(c[e-o]=n)}if(0!==f.hi||1!==f.lo||s!==e)throw new Error("Invalid cashaddr checksum.");return[s,c.slice(0,-8)]}(t,e),i=5*n.length&7;if(i>=5)throw new Error("Invalid padding in data.");if(n[n.length-1]&(1<<i)-1)throw new Error("Non zero padding.");const o=_t(n,0,n,0,5,8,!1),f=o[0]>>>3&31,s=o.slice(1);let h=20+4*(3&o[0]);if(4&o[0]&&(h*=2),h!==s.length)throw new Error("Invalid cashaddr data length.");return{prefix:r,type:f,hash:s}}const Bt=function(t){function e(e){var r=e.slice(0,-4),n=e.slice(-4),i=t(r);if(!(n[0]^i[0]|n[1]^i[1]|n[2]^i[2]|n[3]^i[3]))return r}return{bs58Encode:function(e){var r=t(e);return o.encode(Buffer.concat([e,r],e.length+4))},bs58Decode:function(t){var r=e(o.decode(t));if(!r)throw new Error("Invalid checksum");return r},decodeUnsafe:function(t){var r=o.decodeUnsafe(t);if(r)return e(r)}}}(function(t){var e=(new I).update(t).digest();return(new I).update(e).digest()}),{bs58Decode:xt,bs58Encode:At}=Bt;export{l as b32decode,d as b32encode,xt as bs58Decode,At as bs58Encode,it as calculateChecksum,Et as cashaddrDecode,It as cashaddrEncode,k as codec,rt as decodeCheck,nt as encodeCheck,J as eosPublicKey,c as hex2a,p as isValid,U as isValidChecksumAddress,at as ss58Decode,ut as ss58Encode,C as stripHexPrefix,O as toChecksumAddress,a as ua2hex};
//# sourceMappingURL=index.modern.js.map
